# Exploit Title: Hospital Management System 4.0 - Authentication Bypass & Vertical Privilege Escalation
# Date: 2025-12-20
# Exploit Author: Syntropy Security (Sankalp Devidas Hanwate)
# Vendor Homepage: https://phpgurukul.com/hospital-management-system-in-php/
# Software Link: https://phpgurukul.com/hospital-management-system-in-php/
# Version: 4.0
# Tested on: Linux/Apache/MySQL (LAMP)
# CVE: CVE-2025-XXXX (Waiting for assignment)

# Description:
# The PHPGurukul Hospital Management System v4.0 is vulnerable to a Critical Authentication Bypass 
# leading to Vertical Privilege Escalation. The application fails to enforce Role-Based Access Control (RBAC) 
# on the administrative backend. A low-privileged user (e.g., a self-registered 'Patient') can directly 
# access the Administrator Dashboard and all sub-modules by manually navigating to the '/admin/' directory 
# after logging in.

# Proof of Concept:
# 1. Access the public HMS homepage.
# 2. Click "Patient Login" -> "Create an account".
# 3. Register a new user (e.g., attacker@gmail.com) and log in.
# 4. Once on the 'User Dashboard', manually change the URL in the browser address bar:
#    From: http://localhost/hospital/hms/dashboard.php
#    To:   http://localhost/hospital/hms/admin/dashboard.php
# 5. The application grants full administrative access, allowing the attacker to view logs, 
#    manage doctors, and access sensitive patient data.

# Proof of Concept Video:
# https://drive.google.com/file/d/1xLFDBj3ToSBVgVZ5kRnRPLpIBFJGwumf/view